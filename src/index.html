<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <title>ID 查询工具</title>
</head>
<body>
  <div class="container-fluid">
    <div class="card">
      <div class="card-header bg-primary text-white">
        <h2 class="mb-0">Wwise ID 查询工具</h2>
      </div>

      <!-- 标签页导航 -->
      <ul class="nav nav-tabs tab-header" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link active" id="wwise-tab" data-bs-toggle="tab" data-bs-target="#wwise-content" type="button" role="tab" aria-controls="wwise-content" aria-selected="true">
            📁 Wwise 工程文件
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="waapi-tab" data-bs-toggle="tab" data-bs-target="#waapi-content" type="button" role="tab" aria-controls="waapi-content" aria-selected="false">
            🔌 WAAPI
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="bank-tab" data-bs-toggle="tab" data-bs-target="#bank-content" type="button" role="tab" aria-controls="bank-content" aria-selected="false">
            🏦 Bank 目录
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="config-tab" data-bs-toggle="tab" data-bs-target="#config-content" type="button" role="tab" aria-controls="config-content" aria-selected="false">
            ⚙️ 配置
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="help-tab" data-bs-toggle="tab" data-bs-target="#help-content" type="button" role="tab" aria-controls="help-content" aria-selected="false">
            ❓ 关于/帮助
          </button>
        </li>
      </ul>

      <!-- 共享搜索区域 -->
      <div class="card-body border-bottom" id="sharedSearchArea">
        <!-- 输入区域 -->
        <div class="row mb-3">
          <div class="col-md-12">
            <label for="sharedIdInput" class="form-label"><strong>输入ID字符串</strong></label>
            <input 
              type="text" 
              class="form-control form-control-lg" 
              id="sharedIdInput" 
              placeholder="请输入要查询的ID..."
              autofocus>
          </div>
        </div>

        <!-- 复选框区域 -->
        <div class="row mb-3">
          <div class="col-md-12">
            <label class="form-label"><strong>选择ID类型</strong></label>
            <div class="form-check form-check-inline">
              <input 
                class="form-check-input" 
                type="checkbox" 
                id="sharedGuidCheckbox" 
                value="GUID"
                checked>
              <label class="form-check-label" for="sharedGuidCheckbox">
                GUID
              </label>
            </div>
            <div class="form-check form-check-inline">
              <input 
                class="form-check-input" 
                type="checkbox" 
                id="sharedShortIdCheckbox" 
                value="ShortID"
                checked>
              <label class="form-check-label" for="sharedShortIdCheckbox">
                ShortID
              </label>
            </div>
            <div class="form-check form-check-inline">
              <input 
                class="form-check-input" 
                type="checkbox" 
                id="sharedMediaIdCheckbox" 
                value="MediaID"
                checked>
              <label class="form-check-label" for="sharedMediaIdCheckbox">
                MediaID
              </label>
            </div>
          </div>
        </div>

        <!-- 操作按钮 -->
        <div class="row">
          <div class="col-md-12">
            <button class="btn btn-primary btn-lg me-2" id="sharedSearchBtn">
              🔍 搜索
            </button>
            <button class="btn btn-secondary btn-lg" id="sharedClearBtn">
              🔄 清空
            </button>
          </div>
        </div>
      </div>

      <div class="tab-content">
        <!-- 标签页 1: Wwise 工程文件 -->
        <div class="tab-pane fade show active" id="wwise-content" role="tabpanel" aria-labelledby="wwise-tab">
          <div class="card-body">
            <!-- 配置提示 -->
            <div class="alert alert-warning mb-4" id="wwiseConfigAlert" style="display: none;">
              ⚠️ 请先在"配置"标签页设置 Wwise 工程目录
            </div>

            <!-- 结果表格 -->
            <div class="row">
              <div class="col-md-12">
                <div class="d-flex align-items-center mb-3">
                  <label class="form-label mb-0 me-4"><strong>搜索结果</strong></label>
                  <div class="d-flex align-items-center gap-3">
                    <!-- 分页控件 -->
                    <nav aria-label="分页导航">
                      <ul class="pagination pagination-sm mb-0" data-tab="wwise">
                      </ul>
                    </nav>
                    <!-- 统计信息 -->
                    <small class="text-muted">
                      共找到 <strong class="resultCount" data-tab="wwise">0</strong> 条结果
                      <span class="pageInfo" data-tab="wwise"></span>
                    </small>
                  </div>
                </div>
                <div class="table-responsive">
                  <table class="table table-striped table-hover table-sm">
                    <thead class="table-dark">
                      <tr>
                        <th style="width: 25%;">名称 (Name)</th>
                        <th style="width: 15%;">类型 (Type)</th>
                        <th style="width: 30%;">GUID</th>
                        <th style="width: 15%;">ShortID</th>
                        <th style="width: 15%;">MediaID</th>
                      </tr>
                    </thead>
                    <tbody class="resultsTableBody" data-tab="wwise">
                      <tr>
                        <td colspan="5" class="text-center text-muted">
                          请输入ID并点击搜索
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- 标签页 2: WAAPI -->
        <div class="tab-pane fade" id="waapi-content" role="tabpanel" aria-labelledby="waapi-tab">
          <div class="card-body">
            <!-- 配置提示 -->
            <div class="alert alert-warning mb-4" id="waapiConfigAlert" style="display: none;">
              ⚠️ 请先在"配置"标签页设置 WAAPI 连接信息
            </div>

            <!-- 结果表格 -->
            <div class="row">
              <div class="col-md-12">
                <div class="d-flex align-items-center mb-3">
                  <label class="form-label mb-0 me-4"><strong>搜索结果</strong></label>
                  <div class="d-flex align-items-center gap-3">
                    <!-- 分页控件 -->
                    <nav aria-label="分页导航">
                      <ul class="pagination pagination-sm mb-0" data-tab="waapi">
                      </ul>
                    </nav>
                    <!-- 统计信息 -->
                    <small class="text-muted">
                      共找到 <strong class="resultCount" data-tab="waapi">0</strong> 条结果
                      <span class="pageInfo" data-tab="waapi"></span>
                    </small>
                  </div>
                </div>
                <div class="table-responsive">
                  <table class="table table-striped table-hover table-sm">
                    <thead class="table-dark">
                      <tr>
                        <th style="width: 25%;">名称 (Name)</th>
                        <th style="width: 15%;">类型 (Type)</th>
                        <th style="width: 30%;">GUID</th>
                        <th style="width: 15%;">ShortID</th>
                        <th style="width: 15%;">MediaID</th>
                      </tr>
                    </thead>
                    <tbody class="resultsTableBody" data-tab="waapi">
                      <tr>
                        <td colspan="5" class="text-center text-muted">
                          请输入ID并点击搜索
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- 标签页 3: Bank 目录 -->
        <div class="tab-pane fade" id="bank-content" role="tabpanel" aria-labelledby="bank-tab">
          <div class="card-body">
            <!-- 配置提示 -->
            <div class="alert alert-warning mb-4" id="bankConfigAlert" style="display: none;">
              ⚠️ 请先在"配置"标签页设置 Bank 目录
            </div>

            <!-- 结果表格 -->
            <div class="row">
              <div class="col-md-12">
                <div class="d-flex align-items-center mb-3">
                  <label class="form-label mb-0 me-4"><strong>搜索结果</strong></label>
                  <div class="d-flex align-items-center gap-3">
                    <!-- 分页控件 -->
                    <nav aria-label="分页导航">
                      <ul class="pagination pagination-sm mb-0" data-tab="bank">
                      </ul>
                    </nav>
                    <!-- 统计信息 -->
                    <small class="text-muted">
                      共找到 <strong class="resultCount" data-tab="bank">0</strong> 条结果
                      <span class="pageInfo" data-tab="bank"></span>
                    </small>
                  </div>
                </div>
                <div class="table-responsive">
                  <table class="table table-striped table-hover table-sm">
                    <thead class="table-dark">
                      <tr>
                        <th style="width: 25%;">名称 (Name)</th>
                        <th style="width: 15%;">类型 (Type)</th>
                        <th style="width: 30%;">GUID</th>
                        <th style="width: 15%;">ShortID</th>
                        <th style="width: 15%;">MediaID</th>
                      </tr>
                    </thead>
                    <tbody class="resultsTableBody" data-tab="bank">
                      <tr>
                        <td colspan="5" class="text-center text-muted">
                          请输入ID并点击搜索
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- 标签页 4: 配置 -->
        <div class="tab-pane fade" id="config-content" role="tabpanel" aria-labelledby="config-tab">
          <div class="card-body">
            <!-- 配置管理区域 -->
            <div class="row mb-4 p-3 border rounded">
              <div class="col-md-12">
                <h5 class="mb-3">💾 配置管理</h5>
                <div class="row">
                  <div class="col-md-6">
                    <label for="configSelect" class="form-label"><strong>当前配置</strong></label>
                    <div class="input-group">
                      <select class="form-select" id="configSelect">
                        <option value="default">默认配置</option>
                      </select>
                      <button class="btn btn-outline-primary" type="button" id="loadConfigBtn">
                        📂 加载
                      </button>
                      <button class="btn btn-outline-danger" type="button" id="deleteConfigBtn">
                        🗑️ 删除
                      </button>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <label for="configName" class="form-label"><strong>保存新配置</strong></label>
                    <div class="input-group">
                      <input 
                        type="text" 
                        class="form-control" 
                        id="configName" 
                        placeholder="输入配置名称">
                      <button class="btn btn-success" type="button" id="saveConfigBtn">
                        💾 保存
                      </button>
                    </div>
                  </div>
                </div>
                <small class="text-muted d-block mt-2">
                  💡 提示: 可以为不同的项目或环境保存不同的配置，方便快速切换
                </small>
              </div>
            </div>

            <!-- Wwise工程配置 -->
            <div class="row mb-4 p-3 border rounded">
              <div class="col-md-12">
                <h5 class="mb-3">📁 Wwise 工程配置</h5>
                <label for="wwiseProjPath" class="form-label"><strong>Wwise 工程目录</strong></label>
                <div class="input-group">
                  <input 
                    type="text" 
                    class="form-control" 
                    id="wwiseProjPath" 
                    placeholder="包含 .wproj 文件的目录路径"
                    value="">
                  <button class="btn btn-outline-secondary" type="button" id="wwiseBrowseBtn">
                    浏览...
                  </button>
                </div>
                <small class="text-muted d-block mt-2">示例: C:\Projects\MyWwiseProject</small>
              </div>
            </div>

            <!-- WAAPI配置 -->
            <div class="row mb-4 p-3 border rounded">
              <div class="col-md-12">
                <h5 class="mb-3">🔌 WAAPI 连接配置</h5>
                <div class="row">
                  <div class="col-md-6">
                    <label for="waapiHost" class="form-label"><strong>Host</strong></label>
                    <input 
                      type="text" 
                      class="form-control" 
                      id="waapiHost" 
                      placeholder="WAAPI 服务器地址"
                      value="127.0.0.1">
                  </div>
                  <div class="col-md-6">
                    <label for="waapiPort" class="form-label"><strong>Port</strong></label>
                    <input 
                      type="number" 
                      class="form-control" 
                      id="waapiPort" 
                      placeholder="WAAPI 服务器端口"
                      value="8080"
                      min="1"
                      max="65535">
                  </div>
                </div>
                <div class="mt-3">
                  <button class="btn btn-sm btn-outline-primary" type="button" id="waapiTestBtn">
                    🧪 测试连接
                  </button>
                  <small class="text-muted d-block mt-2">默认连接地址: ws://127.0.0.1:8080</small>
                </div>
              </div>
            </div>

            <!-- Bank目录配置 -->
            <div class="row mb-4 p-3 border rounded">
              <div class="col-md-12">
                <h5 class="mb-3">🏦 Bank 目录配置</h5>
                <label for="bankDirPath" class="form-label"><strong>Bank 目录</strong></label>
                <div class="input-group">
                  <input 
                    type="text" 
                    class="form-control" 
                    id="bankDirPath" 
                    placeholder="包含 SoundbanksInfo.xml 或 .json 的目录路径"
                    value="">
                  <button class="btn btn-outline-secondary" type="button" id="bankBrowseBtn">
                    浏览...
                  </button>
                </div>
                <small class="text-muted d-block mt-2">示例: C:\Projects\MyGame\Soundbanks</small>
              </div>
            </div>
          </div>
        </div>

        <!-- 标签页 5: 关于/帮助 -->
        <div class="tab-pane fade" id="help-content" role="tabpanel" aria-labelledby="help-tab">
          <div class="card-body">
            <!-- 应用信息 -->
            <div class="row mb-4 p-3 border rounded">
              <div class="col-md-12">
                <div class="text-center mb-4">
                  <h3 class="mb-3">🎵 WID - Wwise ID 查询工具</h3>
                  <p class="text-muted mb-0">版本: 0.1.0</p>
                  <p class="text-muted">高效的 Wwise 音频资源 ID 查询和管理工具</p>
                </div>
              </div>
            </div>

            <!-- 功能介绍 -->
            <div class="row mb-4 p-3 border rounded">
              <div class="col-md-12">
                <h5 class="mb-3">✨ 主要功能</h5>
                <div class="row">
                  <div class="col-md-6">
                    <ul class="list-unstyled">
                      <li class="mb-2">📁 <strong>Wwise 工程文件查询</strong><br>
                        <small class="text-muted">直接解析本地 .wproj 文件和相关 XML 资源</small>
                      </li>
                      <li class="mb-2">🔌 <strong>WAAPI 实时查询</strong><br>
                        <small class="text-muted">通过 WebSocket 连接到 Wwise Authoring Tool</small>
                      </li>
                      <li class="mb-2">🏦 <strong>SoundBank 查询</strong><br>
                        <small class="text-muted">解析 SoundbanksInfo.xml 和 JSON 格式文件</small>
                      </li>
                    </ul>
                  </div>
                  <div class="col-md-6">
                    <ul class="list-unstyled">
                      <li class="mb-2">🔍 <strong>多种 ID 类型支持</strong><br>
                        <small class="text-muted">GUID、ShortID、MediaID 组合查询</small>
                      </li>
                      <li class="mb-2">💾 <strong>智能配置管理</strong><br>
                        <small class="text-muted">多配置保存与快速切换</small>
                      </li>
                      <li class="mb-2">📊 <strong>高效结果展示</strong><br>
                        <small class="text-muted">分页显示、详细信息、即时搜索</small>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>

            <!-- 快速入门 -->
            <div class="row mb-4 p-3 border rounded">
              <div class="col-md-12">
                <h5 class="mb-3">🚀 快速入门</h5>
                <div class="accordion" id="quickStartAccordion">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="headingOne">
                      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                        📁 如何使用 Wwise 工程文件查询
                      </button>
                    </h2>
                    <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#quickStartAccordion">
                      <div class="accordion-body">
                        <ol>
                          <li>点击 <strong>"配置"</strong> 标签页</li>
                          <li>在 <strong>"Wwise 工程配置"</strong> 区域设置包含 .wproj 文件的目录</li>
                          <li>返回 <strong>"Wwise 工程文件"</strong> 标签页</li>
                          <li>输入要查询的 ID，选择 ID 类型，点击搜索</li>
                        </ol>
                      </div>
                    </div>
                  </div>
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="headingTwo">
                      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                        🔌 如何使用 WAAPI 实时查询
                      </button>
                    </h2>
                    <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#quickStartAccordion">
                      <div class="accordion-body">
                        <ol>
                          <li>确保 Wwise Authoring Tool 已启动</li>
                          <li>在 Wwise 中启用 WAAPI 服务（Project → User Preferences... → Wwise Authoring API）</li>
                          <li>
                            <strong>配置浏览器跨域访问</strong>：在 WAAPI 设置中的 "Allow browser connections from:" 字段添加以下地址：
                            <div class="mt-2 p-2 bg-light border rounded">
                              <code>http://tauri.localhost,https://tauri.localhost,http://127.0.0.1:1430</code>
                            </div>
                            <small class="text-muted">
                              💡 这些地址用于允许本桌面应用与 Wwise 的 WAAPI 服务进行跨域通信
                            </small>
                          </li>
                          <li>在本工具的 <strong>"配置"</strong> 中设置 WAAPI 连接信息（通常是 127.0.0.1:8080）</li>
                          <li>点击 <strong>"测试连接"</strong> 确认连接状态</li>
                        </ol>
                      </div>
                    </div>
                  </div>
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="headingThree">
                      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                        🏦 如何使用 Bank 目录查询
                      </button>
                    </h2>
                    <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#quickStartAccordion">
                      <div class="accordion-body">
                        <ol>
                          <li>确保已通过 Wwise 生成了 SoundBank 文件</li>
                          <li>找到包含 <code>SoundbanksInfo.xml</code> 或 <code>.json</code> 文件的目录</li>
                          <li>在 <strong>"配置"</strong> 标签页的 "Bank 目录配置" 中设置该目录路径</li>
                          <li>返回 <strong>"Bank 目录"</strong> 标签页</li>
                          <li>输入要查询的 ID，选择 ID 类型，点击搜索</li>
                        </ol>
                      </div>
                    </div>
                  </div>
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="headingFour">
                      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                        💾 如何管理多个配置
                      </button>
                    </h2>
                    <div id="collapseFour" class="accordion-collapse collapse" aria-labelledby="headingFour" data-bs-parent="#quickStartAccordion">
                      <div class="accordion-body">
                        <ol>
                          <li>在 <strong>"配置"</strong> 标签页设置好所有路径和连接信息</li>
                          <li>在 <strong>"配置管理"</strong> 区域输入配置名称（如"项目A"、"测试环境"）</li>
                          <li>点击 <strong>"💾 保存"</strong> 按钮</li>
                          <li>使用 <strong>"当前配置"</strong> 下拉列表快速切换不同配置</li>
                        </ol>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- 技术支持与链接 -->
            <div class="row mb-4 p-3 border rounded">
              <div class="col-md-12">
                <h5 class="mb-3">📞 技术支持与更多信息</h5>
                <div class="row">
                  <div class="col-md-6">
                    <h6 class="text-primary">🔗 项目链接</h6>
                    <div class="d-grid gap-2">
                      <button type="button" onclick="openExternalLink('https://github.com/xmimu/wid')" class="btn btn-primary btn-sm d-flex align-items-center justify-content-start">
                        <span class="me-2">📱</span>GitHub 仓库
                      </button>
                      <button type="button" onclick="openExternalLink('https://github.com/xmimu/wid/blob/master/README.md')" class="btn btn-primary btn-sm d-flex align-items-center justify-content-start">
                        <span class="me-2">📖</span>完整说明文档
                      </button>
                      <button type="button" onclick="openExternalLink('https://github.com/xmimu/wid/releases')" class="btn btn-primary btn-sm d-flex align-items-center justify-content-start">
                        <span class="me-2">📦</span>下载最新版本
                      </button>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <h6 class="text-success">💬 问题反馈</h6>
                    <div class="d-grid gap-2">
                      <button type="button" onclick="openExternalLink('https://github.com/xmimu/wid/issues')" class="btn btn-success btn-sm d-flex align-items-center justify-content-start">
                        <span class="me-2">🐛</span>报告问题
                      </button>
                      <button type="button" onclick="openExternalLink('https://github.com/xmimu/wid/discussions')" class="btn btn-success btn-sm d-flex align-items-center justify-content-start">
                        <span class="me-2">💭</span>讨论交流
                      </button>
                      <button type="button" onclick="openExternalLink('mailto:1101588023@qq.com')" class="btn btn-success btn-sm d-flex align-items-center justify-content-start">
                        <span class="me-2">✉️</span>邮件联系
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- 版权信息 -->
            <div class="row p-3 border rounded bg-light">
              <div class="col-md-12 text-center">
                <p class="mb-2">
                  <strong>技术栈</strong>: Tauri 2.0 + Rust + HTML5 + JavaScript + Bootstrap 5
                </p>
                <p class="mb-0 text-muted">
                  Made with ❤️ by <button type="button" onclick="openExternalLink('https://github.com/xmimu')" class="btn btn-link p-0 text-muted text-decoration-none" style="vertical-align: baseline;">xmimu</button> 
                  | © 2025 MIT License
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="lib/bootstrap.bundle.min.js"></script>
  <!-- Autobahn.js for WAAPI -->
  <script src="lib/autobahn.min.js"></script>
  <!-- WAAPI Helper -->
  <script src="js/waapi.js"></script>
  <!-- WAAPI Query Module -->
  <script src="js/waapi-query.js"></script>
  <!-- Main Application -->
  <script src="js/main.js"></script>
  <!-- External Links Module -->
  <script src="js/external-links.js"></script>
</body>
</html>